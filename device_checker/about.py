"""
About portion of main page document
"""

from device_checker import APP_VERSION, APP_NAME

LICENSES = [
    {
        'title': 'Python 3.6.4',
        'url': 'https://python.org',
        'url_license': 'https://docs.python.org/3/license.html',
        'text': """1. This LICENSE AGREEMENT is between the Python Software Foundation ("PSF"), and<br>
   the Individual or Organization ("Licensee") accessing and otherwise using Python<br>
   3.6.4 software in source or binary form and its associated documentation.<br>
<br>
2. Subject to the terms and conditions of this License Agreement, PSF hereby<br>
   grants Licensee a nonexclusive, royalty-free, world-wide license to reproduce,<br>
   analyze, test, perform and/or display publicly, prepare derivative works,<br>
   distribute, and otherwise use Python 3.6.4 alone or in any derivative<br>
   version, provided, however, that PSF's License Agreement and PSF's notice of<br>
   copyright, i.e., "Copyright © 2001-2018 Python Software Foundation; All Rights<br>
   Reserved" are retained in Python 3.6.4 alone or in any derivative version<br>
   prepared by Licensee.<br>
<br>
3. In the event Licensee prepares a derivative work that is based on or<br>
   incorporates Python 3.6.4 or any part thereof, and wants to make the<br>
   derivative work available to others as provided herein, then Licensee hereby<br>
   agrees to include in any such work a brief summary of the changes made to Python<br>
   3.6.4.<br>
<br>
4. PSF is making Python 3.6.4 available to Licensee on an "AS IS" basis.<br>
   PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED.  BY WAY OF<br>
   EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND DISCLAIMS ANY REPRESENTATION OR<br>
   WARRANTY OF MERCHANTABILITY OR FITNESS FOR ANY PARTICULAR PURPOSE OR THAT THE<br>
   USE OF PYTHON 3.6.4 WILL NOT INFRINGE ANY THIRD PARTY RIGHTS.<br>
<br>
5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON 3.6.4<br>
   FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS A RESULT OF<br>
   MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON 3.6.4, OR ANY DERIVATIVE<br>
   THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.<br>
<br>
6. This License Agreement will automatically terminate upon a material breach of<br>
   its terms and conditions.<br>
<br>
7. Nothing in this License Agreement shall be deemed to create any relationship<br>
   of agency, partnership, or joint venture between PSF and Licensee.  This License<br>
   Agreement does not grant permission to use PSF trademarks or trade name in a<br>
   trademark sense to endorse or promote products or services of Licensee, or any<br>
   third party.<br>
<br>
8. By copying, installing or otherwise using Python 3.6.4, Licensee agrees<br>
   to be bound by the terms and conditions of this License Agreement."""
    },
    {
        'title': 'wxWindows Library Licence, Version 3.1',
        'url': 'https://www.wxpython.org/pages/license/',
        'url_license': 'https://www.wxpython.org/pages/license/',
        'text': """wxWindows Library Licence, Version 3.1<br>
              ======================================<br>
<br>
Copyright (c) 1998-2005 Julian Smart, Robert Roebling et al<br>
<br>
Everyone is permitted to copy and distribute verbatim copies<br>
of this licence document, but changing it is not allowed.<br>
<br>
                     WXWINDOWS LIBRARY LICENCE<br>
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION<br>
<br>
This library is free software; you can redistribute it and/or modify it<br>
under the terms of the GNU Library General Public Licence as published by<br>
the Free Software Foundation; either version 2 of the Licence, or (at your<br>
option) any later version.<br>
<br>
This library is distributed in the hope that it will be useful, but WITHOUT<br>
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or<br>
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Library General Public<br>
Licence for more details.<br>
<br>
You should have received a copy of the GNU Library General Public Licence<br>
along with this software, usually in a file named COPYING.LIB.  If not,<br>
write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth<br>
Floor, Boston, MA 02110-1301 USA.<br>
<br>
EXCEPTION NOTICE<br>
<br>
1. As a special exception, the copyright holders of this library give<br>
permission for additional uses of the text contained in this release of the<br>
library as licenced under the wxWindows Library Licence, applying either<br>
version 3.1 of the Licence, or (at your option) any later version of the<br>
Licence as published by the copyright holders of version 3.1 of the Licence<br>
document.<br>
<br>
2. The exception is that you may use, copy, link, modify and distribute<br>
under your own terms, binary object code versions of works based on the<br>
Library.<br>
<br>
3. If you copy code from files distributed under the terms of the GNU<br>
General Public Licence or the GNU Library General Public Licence into a<br>
copy of this library, as this licence permits, the exception does not apply<br>
to the code that you add in this way.  To avoid misleading anyone as to the<br>
status of such modified files, you must delete this exception notice from<br>
such code and/or adjust the licensing conditions notice accordingly.<br>
<br>
4. If you write modifications of your own for this library, it is your<br>
choice whether to permit this exception to apply to your modifications.  If<br>
you do not wish that, you must delete the exception notice from such code<br>
and/or adjust the licensing conditions notice accordingly."""
    },
    {
        'title': 'requests',
        'url': 'http://docs.python-requests.org',
        'url_license': 'https://github.com/requests/requests/blob/master/LICENSE',
        'text': """Copyright 2017 Kenneth Reitz<br>
<br>
   Licensed under the Apache License, Version 2.0 (the "License");<br>
   you may not use this file except in compliance with the License.<br>
   You may obtain a copy of the License at<br>
<br>
       http://www.apache.org/licenses/LICENSE-2.0<br>
<br>
   Unless required by applicable law or agreed to in writing, software<br>
   distributed under the License is distributed on an "AS IS" BASIS,<br>
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>
   See the License for the specific language governing permissions and<br>
limitations under the License."""
    },
    {
        'title': 'Python for Windows (pywin32) Extensions ',
        'url': 'https://github.com/mhammond/pywin32',
        'url_license': 'https://docs.python.org/3/license.html',
        'text': """1. This LICENSE AGREEMENT is between the Python Software Foundation ("PSF"), and<br>
   the Individual or Organization ("Licensee") accessing and otherwise using Python<br>
   3.6.4 software in source or binary form and its associated documentation.<br>
<br>
2. Subject to the terms and conditions of this License Agreement, PSF hereby<br>
   grants Licensee a nonexclusive, royalty-free, world-wide license to reproduce,<br>
   analyze, test, perform and/or display publicly, prepare derivative works,<br>
   distribute, and otherwise use Python 3.6.4 alone or in any derivative<br>
   version, provided, however, that PSF's License Agreement and PSF's notice of<br>
   copyright, i.e., "Copyright © 2001-2018 Python Software Foundation; All Rights<br>
   Reserved" are retained in Python 3.6.4 alone or in any derivative version<br>
   prepared by Licensee.<br>
<br>
3. In the event Licensee prepares a derivative work that is based on or<br>
   incorporates Python 3.6.4 or any part thereof, and wants to make the<br>
   derivative work available to others as provided herein, then Licensee hereby<br>
   agrees to include in any such work a brief summary of the changes made to Python<br>
   3.6.4.<br>
<br>
4. PSF is making Python 3.6.4 available to Licensee on an "AS IS" basis.<br>
   PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED.  BY WAY OF<br>
   EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND DISCLAIMS ANY REPRESENTATION OR<br>
   WARRANTY OF MERCHANTABILITY OR FITNESS FOR ANY PARTICULAR PURPOSE OR THAT THE<br>
   USE OF PYTHON 3.6.4 WILL NOT INFRINGE ANY THIRD PARTY RIGHTS.<br>
<br>
5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON 3.6.4<br>
   FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS A RESULT OF<br>
   MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON 3.6.4, OR ANY DERIVATIVE<br>
   THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.<br>
<br>
6. This License Agreement will automatically terminate upon a material breach of<br>
   its terms and conditions.<br>
<br>
7. Nothing in this License Agreement shall be deemed to create any relationship<br>
   of agency, partnership, or joint venture between PSF and Licensee.  This License<br>
   Agreement does not grant permission to use PSF trademarks or trade name in a<br>
   trademark sense to endorse or promote products or services of Licensee, or any<br>
   third party.<br>
<br>
8. By copying, installing or otherwise using Python 3.6.4, Licensee agrees<br>
   to be bound by the terms and conditions of this License Agreement."""
    },
]


def get_welcome_page() -> str:
    """
    Get HTML text body for welcome page on program startup

    :return: HTML body welcome page
    """

    body = (
        "<h4><u>{APP_NAME} beta v{APP_VERSION}</u></h4>"
        "<h5>What {APP_NAME} Does</h5>"
        "{APP_NAME} scans your system and notifies you to changes.<br>"
        "It will notify you when things are added, removed, or changed.<br>"
        "{APP_NAME} is not like an anti-virus. It does not detect malicious things. <br>"
        "{APP_NAME} is <b>not</b> a replacement for anti-virus or anti-malware software.<br>"
        ""
        "<h5>How to Use</h5>"
        "Press the 'Generate New' button to gather the data about your system and generate a report.<br>"
        "The 'View Changed Data' drop down will show you areas of your system that have changed since the "
        "last report.<br>"
        "The report will tell you what has been added, removed, or changed.<br>"
        "The 'View Last Data' drop down lets you view all the data that {APP_NAME} has gathered.<br>"
        "The 'Data to Collect' area contains check boxes that control which data will be gathered.<br>"
        "The 'Delete Changed Data' button will erase data in the 'View Changed Data' drop down.<br>"
        ""
        "<h5>How Data is Collected</h5>"
        "{APP_NAME} runs several system commands to collect data.<br>"
        "The next time data is collected it is compared with the last data collection to detect changes.<br>"
        "The changed data is saved and added to until it has been deleted.<br>"
        "It is recommended that you delete the changed data once you have reviewed it.<br>"
        ""
        "<h5>Notes</h5>"
        "<ul>"
        "<li>"
        "   'Services' that have a 'PathName' that start with 'C:\WINDOWS\System32\svchost.exe -k' are filtered "
        "   out since Windows frequently changes them."
        "</li>"
        "<li>"
        "   Gathering data for 'Installed Programs' might be slow."
        "</li>"
        "</ul>"
        ""
        "<h5>Running Automatically</h5>"
        "To run {APP_NAME} automatically and detect changes, follow the steps below."
        "<ol>"
        "<li>Click Start</li>"
        "<li>Search for 'Task Scheduler'</li>"
        "<li>On the right side, click 'Create Basic Task...'</li>"
        "<li>Enter a 'Name'. eg <strong>{APP_NAME}</strong></li>"
        "<li>Click 'Next'</li>"
        "<li>Choose when you want {APP_NAME} to run</li>"
        "<li>Click 'Next'</li>"
        "<li>Set any additional configurations if it appears then click 'Next'</li>"
        "<li>For the 'Action' tab choose 'Start a Program'</li>"
        "<li>For 'Program/script' browse to the {APP_NAME} exe. Probably "
        "'C:\\Program Files (x86)\\shayConcepts\\Device Checker\\Device Checker.exe'</li>"
        "<li>For 'Add arguments (optional)', enter <strong>--generate</strong></li>"
        "<li>Click 'Next'</li>"
        "<li>Click 'Finish'</li>"
        "<li>You may close 'Task Scheduler'</li>"
        "<li>After {APP_NAME} runs, if changes were detected, a popup will appear</li>"
        "</ol>"
        "<h4>About {APP_NAME}</h4>"
        "Version: {APP_VERSION}<br>"
        "Website: https://shayConcepts.com<br>"
        "<h5>Open Source Libraries</h5>"
        "{APP_NAME} is built using great open source software.<br><br><br>"
    ).format(APP_NAME=APP_NAME, APP_VERSION=APP_VERSION)

    for lib in LICENSES:
        lib_text = "<strong>{}</strong><br>".format(lib['title'])
        lib_text += "{}&nbsp;&nbsp;-&nbsp;&nbsp;{}<br><br>".format(lib['url'], lib['url_license'])
        lib_text += '<div style="border: 1px solid #000; overflow: scroll; max-height: 500px; padding: 10px 10px 10px 10px; background-color: #fff;">{}</div>'.format(
            lib['text'])
        lib_text += "<br><br>"
        body += lib_text

    return body
